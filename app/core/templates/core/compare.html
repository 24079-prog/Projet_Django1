<h1>Comparaison des actifs</h1>

<form method="get">
  <!-- Sélecteur de période -->
  <select name="period">
    <option value="7d" {% if period == "7d" %}selected{% endif %}>7 jours</option>
    <option value="1m" {% if period == "1m" %}selected{% endif %}>1 mois</option>
    <option value="3m" {% if period == "3m" %}selected{% endif %}>3 mois</option>
    <option value="6m" {% if period == "6m" %}selected{% endif %}>6 mois</option>
    <option value="1y" {% if period == "1y" %}selected{% endif %}>1 an</option>
    <option value="2y" {% if period == "2y" %}selected{% endif %}>2 ans</option>
  </select>

  <br><br>

  <!-- Sélection des assets -->
  {% for a in assets %}
    <label>
      <input type="checkbox" name="assets" value="{{ a.code }}"
             {% if a.code in selected %}checked{% endif %}>
      {{ a.code }}
    </label>
  {% endfor %}

  <br><br>
  <button type="submit">Comparer</button>
</form>

<canvas id="chart"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const datasets = [];
{% for s in series %}
datasets.push({
  label: "{{ s.label }}",
  data: {{ s.values|safe }},
  borderWidth: 2,
});
{% endfor %}

new Chart(document.getElementById("chart"), {
  type: "line",
  data: {
    labels: {{ series.0.dates|default:"[]"|safe }},
    datasets: datasets
  }
});
</script>
